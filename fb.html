<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHM CRUD Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root { --header-color: #1a237e; }
        body { background-color: #f8f9fa; font-family: 'Segoe UI', sans-serif; }
        .container { max-width: 1000px; padding: 15px; }
        .table-card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        th, td { text-align: center !important; vertical-align: middle !important; padding: 12px !important; }
        thead { background: var(--header-color); color: white; }
        
        .formula-text { font-size: 28px; color: #1a237e; font-weight: bold; display: block; }
        mjx-container { font-size: 1.4em !important; }

        .admin-section { display: none; background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid #ddd; }
        
        /* বাটন স্টাইল */
        .btn-action { padding: 5px 10px; font-size: 12px; border-radius: 5px; cursor: pointer; border: none; }
        .btn-edit { background: #ffc107; color: #000; }
        .btn-delete { background: #dc3545; color: #fff; margin-left: 5px; }

        @media print {
            .no-print { display: none !important; }
            .container { max-width: 100% !important; margin: 0 !important; }
            th:last-child, td:last-child { display: none; } /* প্রিন্টে Action কলাম বাদ */
            .formula-text { font-size: 30px !important; }
        }
    </style>
</head>
<body>

<div class="container mt-3">
    <div class="d-flex justify-content-between align-items-center mb-3 no-print">
        <h4 class="fw-bold">SHM Formula Manager</h4>
        <div class="d-flex gap-2">
            <button class="btn btn-dark btn-sm" onclick="showAddPanel()">+ Add New</button>
            <button class="btn btn-primary btn-sm" onclick="window.print()">Print</button>
        </div>
    </div>

    <div id="adminPanel" class="admin-section no-print">
        <h6 id="panelTitle" class="mb-3 fw-bold">নতুন সূত্র যোগ করুন</h6>
        <input type="hidden" id="editIndex"> <div class="row g-2">
            <div class="col-12 col-md-4"><input type="text" id="nameInput" class="form-control" placeholder="নাম"></div>
            <div class="col-12 col-md-4"><input type="text" id="formulaInput" class="form-control" placeholder="সূত্র \(...\)"></div>
            <div class="col-12 col-md-4"><input type="text" id="descInput" class="form-control" placeholder="ব্যাখ্যা"></div>
            <div class="col-12 mt-3">
                <button class="btn btn-success w-100 py-2 fw-bold" id="saveBtn" onclick="saveFormula()">Save Formula</button>
                <button class="btn btn-secondary w-100 mt-2" onclick="closePanel()">Cancel</button>
            </div>
        </div>
    </div>

    <div class="table-card shadow">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>নাম</th>
                        <th>সূত্র</th>
                        <th>ব্যাখ্যা</th>
                        <th class="no-print">Action</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    let formulas = JSON.parse(localStorage.getItem('shm_crud_v1')) || [
        { name: "বেগ", formula: "\\(v = \\omega \\sqrt{A^2 - x^2}\\)", desc: "A=বিস্তার" }
    ];

    function renderTable() {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';
        formulas.forEach((item, index) => {
            tbody.innerHTML += `
                <tr>
                    <td class="fw-bold text-dark">${item.name}</td>
                    <td><span class="formula-text">${item.formula}</span></td>
                    <td class="text-muted small">${item.desc}</td>
                    <td class="no-print">
                        <button class="btn-action btn-edit" onclick="editFormula(${index})">Edit</button>
                        <button class="btn-action btn-delete" onclick="deleteFormula(${index})">Del</button>
                    </td>
                </tr>`;
        });
        if (window.MathJax) MathJax.typesetPromise();
        localStorage.setItem('shm_crud_v1', JSON.stringify(formulas));
    }

    function showAddPanel() {
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('panelTitle').innerText = "নতুন সূত্র যোগ করুন";
        document.getElementById('editIndex').value = "";
        clearInputs();
    }

    function closePanel() { document.getElementById('adminPanel').style.display = 'none'; }

    function clearInputs() {
        document.getElementById('nameInput').value = '';
        document.getElementById('formulaInput').value = '';
        document.getElementById('descInput').value = '';
    }

    function saveFormula() {
        const name = document.getElementById('nameInput').value;
        const formula = document.getElementById('formulaInput').value;
        const desc = document.getElementById('descInput').value;
        const editIndex = document.getElementById('editIndex').value;

        if(!name || !formula) return alert("তথ্য দিন!");

        if (editIndex === "") {
            formulas.push({ name, formula, desc });
        } else {
            formulas[editIndex] = { name, formula, desc };
        }

        renderTable();
        closePanel();
    }

    function editFormula(index) {
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('panelTitle').innerText = "সূত্র আপডেট করুন";
        document.getElementById('nameInput').value = formulas[index].name;
        document.getElementById('formulaInput').value = formulas[index].formula;
        document.getElementById('descInput').value = formulas[index].desc;
        document.getElementById('editIndex').value = index;
    }

    function deleteFormula(index) {
        if(confirm("আপনি কি নিশ্চিত এটি ডিলিট করতে চান?")) {
            formulas.splice(index, 1);
            renderTable();
        }
    }

    renderTable();
</script>
</body>
</html>
